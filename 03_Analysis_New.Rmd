---
title: "Attitudes toward Redistribution"
output:
  html_document:
    df_print: paged
---
TO DO:
Soeren - could you add 2019 to the graphs?



Question - the inclarge question was not asked in the environment module I guess, so we drop it

Nate - get newer measure of socx from OECD, other macro-level variables (GDP in particular)


##### ISSP, Social Inequality, Cumulation (1987, 1992, 1999, 2009 & 2019)
##### ISSP, Environment, 1993, 2000 & 2010 (not asked, can't use)
$~$
$~$

#### **Nate Breznau, Lisa Heukamp & Hung H.V. Nguyen**
#### **University of Bremen**

_____________________________________________________________________________

$~$
$~$

Working paper available here: https://docs.google.com/document/d/1mST25rKYZ5wChRj5WyhxH_65RUa9MNR2OsO5B4-qcwY/edit#

Github repo: https://github.com/hungnguyen167/Social-Status



```{r, include = F}
rm(list = ls())
```


```{r setup, include=FALSE}
library(pacman)
pacman::p_load("tidyverse",
               "knitr",
               "lavaan",
               "kableExtra",
               "semTools",
               "ggplot2",
               "ragg",
               "sjPlot",
               "lme4",
               "readxl")

knitr::opts_chunk$set(message = F, warning = F)

```





## Descriptives

### Table 1. Cases by Country-Wave

```{r tbl1, include = T, echo = T}
# Run this if you still have the old socstat version
# df$female <- ifelse(df$female == 8, NA, df$female)


# Cross-tab years and countries
options(knitr.kable.NA = '')
tab1 <- df_na %>%
  dplyr::group_by(country, wave) %>%
  dplyr::summarize(n=n()) %>%
  spread(wave, n) %>%
  kable(., 
        #col.names = c("Country", "SI_1987", "SI_1992", "EN_1993", "SI_1999", "EN_2000", "SI_2009", "EN_2010", "SI_2019"), 
        caption = "Country Sample Size by Wave, ISSP 'Social Inequality (SI)", format.args = list(big.mark = ","))

kable_styling(tab1)
```

## Macro-Correlations


```{r var_dvs}
df_macro <- df_na %>%
  select(iso3c, wave, reduce, reduce_large, gini_disp, gini_mkt, socx, socx_perhead, cpi15_20, liberal_i, confidence_gov_i, democratic_i, gdp_pc_10k, regime)

df_macro_corr <- df_macro %>%
  select(-c(iso3c, wave)) %>%
  cor(., use = "pairwise.complete.obs") %>%
  as.data.frame() %>%
  round(.,2)
```

### Step Two - Variation incdiff/inclarge

```{r twovar_compare}

```

### Theory

After observing the variation in the correlation between inclarge and incdiff by country. We suspect that attitudes toward the role of government are in play. We suspect these come from institutionalized norms. 

Theory: individuals have values or follow norms about how much the government should intervene in the socio-economic affairs of individuals, how much the government should protect against social risks and how much the government (society) should share or redistribute based on need. 

Hypothesis: In countries where the government does less redistribution or has a weaker welfare state, the correlation between perceptions of the income gap and the idea that the government is responsible for doing something about it will be smaller.


Example: In the US the public may perceive a high or undesirable amount of income inequality, but be less likely to agree that the government should do something about it. Whereas in Germany the public may also perceive a high degree of inequality but be more likely to express that the government should do (is responsible) for doing something about it. 

### Multilevel Models
```{r mlms}
M00 <- lmer(reduce ~ 1 + (1 | iso3c), data = df_na)
M00.5 <- lmer(reduce ~ 1 + reduce_large + (1 | iso3c), data = df_na)
M01 <- lmer(reduce ~ 1 + reduce_large + (1 + reduce_large | iso3c), data = df_na)
M02 <- lmer(reduce ~ 1 + reduce_large*socx + (1 + reduce_large | iso3c), data = df_na)
M03 <- lmer(reduce ~ 1 + reduce_large*gini_disp + (1 + reduce_large | iso3c), data = df_na)

tab_model(M00, M00.5, M01, M02, M03, show.ci = F, p.style = "stars")

```

### Plot SOCX and slope

```{r}

```

